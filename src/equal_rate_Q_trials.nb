(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11005,        308]
NotebookOptionsPosition[     10517,        287]
NotebookOutlinePosition[     10876,        303]
CellTagsIndexPosition[     10833,        300]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"1", "/", "19"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", " ", "[", 
      RowBox[{"a", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "20"}], "}"}]}], "]"}], "-", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"20", "*", "a"}], ",", "20"}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", " ", 
        RowBox[{"Q", ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"r", " ", "t", " ", "Q"}], "]"}]}]}], ")"}], "/", " ", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"r", " ", "t", " ", "Q"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{"t", " ", "r", " ", "Q"}], "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.664004842799451*^9, 3.664004848864064*^9}, {
   3.66400499509441*^9, 3.664005227811648*^9}, {3.664005649225257*^9, 
   3.664005917338869*^9}, {3.66400609282237*^9, 3.6640061006065283`*^9}, 
   3.666568491816732*^9, {3.6665693318893957`*^9, 3.6665694140482492`*^9}, {
   3.666570102215657*^9, 3.66657010373349*^9}, {3.6665701405124826`*^9, 
   3.666570182587064*^9}, {3.666570212615382*^9, 3.666570346365706*^9}, {
   3.6665703811392593`*^9, 3.666570387053298*^9}, {3.666570432440843*^9, 
   3.666570456506806*^9}, {3.6759600387293663`*^9, 3.675960065816936*^9}, {
   3.675960554448185*^9, 3.675960573068795*^9}, {3.676026737429824*^9, 
   3.676026749531205*^9}, {3.6762037544015913`*^9, 3.676203777218629*^9}, {
   3.676205383867031*^9, 3.676205433954672*^9}, {3.676218702290306*^9, 
   3.6762187088076267`*^9}, {3.6762205553491488`*^9, 3.676220567388331*^9}, {
   3.676220663293435*^9, 3.676220663692687*^9}, {3.6762207659172897`*^9, 
   3.676220766365178*^9}, {3.6762210118492117`*^9, 3.6762210144330606`*^9}, {
   3.676262479919265*^9, 3.6762624892185*^9}, {3.694539094661075*^9, 
   3.6945390990169773`*^9}, 3.694539399042955*^9, 3.6945394419635983`*^9, {
   3.694539473864149*^9, 3.6945394749928617`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"20", "cOne", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"18", 
            RowBox[{"e", "^", 
             RowBox[{"(", 
              RowBox[{"20", "t"}], ")"}]}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"19", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"e", "^", 
            RowBox[{"(", 
             RowBox[{"20", "t"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"20", "cTwo", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "19"}], "+", 
           RowBox[{"18", 
            RowBox[{"e", "^", 
             RowBox[{"(", 
              RowBox[{"20", "t"}], ")"}]}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"19", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "9"}], "+", 
           RowBox[{"e", "^", 
            RowBox[{"(", 
             RowBox[{"20", "t"}], ")"}]}]}], ")"}]}], ")"}]}]}], "\[Equal]", 
     "0"}], ",", "t"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6665695895546083`*^9, 3.666569721568872*^9}, {
   3.666569944902437*^9, 3.666569950861644*^9}, {3.666570412814172*^9, 
   3.6665704287548723`*^9}, {3.666570484542642*^9, 3.666570506516094*^9}, 
   3.6945385935597353`*^9, {3.695421936285493*^9, 3.695421937047819*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", "=", " ", 
     RowBox[{"1", "/", "60"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Table", " ", "[", 
        RowBox[{"a", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "61"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "61"}], "}"}]}], "]"}], "-", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"61", "*", "a"}], ",", "61"}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MatrixExp", "[", " ", 
        RowBox[{"t", " ", "Q"}], "]"}], ".", "Q"}], ")"}], "/", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{"t", " ", "Q"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"Simplify", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Q", ".", 
          RowBox[{"MatrixExp", "[", " ", 
           RowBox[{"t", " ", "Q"}], "]"}]}], ")"}], "/", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"rt", " ", "Q"}], "]"}]}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6945385959489594`*^9, 3.694538608170516*^9}, {
   3.694538647216689*^9, 3.694538696638897*^9}, {3.694538742479486*^9, 
   3.6945388181606092`*^9}, {3.694538851866787*^9, 3.6945388531664667`*^9}, {
   3.694539108953246*^9, 3.6945391119688396`*^9}, 3.6945393835118027`*^9, {
   3.694539426854555*^9, 3.6945394376916933`*^9}, {3.694539509334744*^9, 
   3.694539516943295*^9}, {3.6945395492818823`*^9, 3.6945395505547247`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "2"}], ",", "0", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", 
       RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1.297", ",", " ", "1.297"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1.297", ",", " ", "1.297"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.297"}], ",", " ", 
       RowBox[{"-", "1.297"}], ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.297"}], ",", " ", 
       RowBox[{"-", "1.297"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"mu", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S", "/", "1"}], "-", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"-", "S"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Q", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.7849"}], ",", "1", ",", "1.7849", ",", "0"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "2.7849"}], ",", "0", ",", "1.7849"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.4879", ",", "0", ",", 
         RowBox[{"-", "1.4879"}], ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.4879", ",", "1", ",", 
         RowBox[{"-", "1.4879"}]}], "}"}]}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "=", " ", 
  RowBox[{"MatrixForm", "[", " ", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"t", " ", "Q"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6954219452005*^9, 3.695421967540666*^9}, {
  3.695427445417968*^9, 3.695427611439375*^9}, {3.6954278533763523`*^9, 
  3.695427890784176*^9}, {3.695427962713393*^9, 3.695428001010803*^9}, {
  3.6966896474897013`*^9, 3.696689729740616*^9}, {3.6966897713602858`*^9, 
  3.696689915056931*^9}, {3.69669061370545*^9, 3.696690781835361*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.10733456556803346`", "0.10733456512556738`", "0.3926654354625405`", 
      "0.3926654338438527`"},
     {"0.10733456512556741`", "0.10733456556803346`", "0.3926654338438529`", 
      "0.39266543546254035`"},
     {"0.1073345655006854`", "0.10733456505821933`", "0.3926654355298884`", 
      "0.3926654339112008`"},
     {"0.10733456505821935`", "0.1073345655006854`", "0.39266543391120096`", 
      "0.3926654355298884`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.695427560146042*^9, 3.69542761213542*^9}, 
   3.696689732852214*^9, 3.696689776735373*^9, {3.696689881881723*^9, 
   3.69668990902757*^9}, 3.696690680411292*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.696689910188006*^9, 3.696689911339078*^9}}]
},
WindowSize->{808, 651},
WindowMargins->{{Automatic, -106}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2479, 55, 80, "Input"],
Cell[3040, 77, 1548, 46, 97, "Input"],
Cell[4591, 125, 1799, 46, 97, "Input"],
Cell[CellGroupData[{
Cell[6415, 175, 2821, 78, 267, "Input"],
Cell[9239, 255, 1167, 26, 92, "Output"]
}, Open  ]],
Cell[10421, 284, 92, 1, 28, "Input"]
}
]
*)

(* End of internal cache information *)
